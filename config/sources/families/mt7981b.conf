#
# SPDX-License-Identifier: GPL-2.0
#
# Copyright (c) 2013-2023 Igor Pecovnik, igor@armbian.com
#
# This file is a part of the Armbian Build Framework
# https://github.com/armbian/build/
#
BOOTSCRIPT='boot-mt7981b.cmd'
#BOOTENV_FILE='mt7623.txt'
#UBOOT_TARGET_MAP=";;$SRC/packages/blobs/mt7623n/BPI-R2-HEAD440-0k.img $SRC/packages/blobs/mt7623n/BPI-R2-HEAD1-512b.img $SRC/packages/blobs/mt7623n/BPI-R2-preloader-2k.img $SRC/packages/blobs/mt7623n/BPI-R2-EMMC-boot0-0K-0905.img u-boot.bin"
BOOTPATCHDIR='legacy'
ARCH=arm64
ATF_COMPILE="no"
EXTRAWIFI="no"

case $BRANCH in
	edge)
		declare -g KERNEL_MAJOR_MINOR="6.5" # Major and minor versions of this kernel.
		declare -g KERNELBRANCH="branch:linux-6.5.y"
		;;
esac


NM_IGNORE_DEVICES="interface-name:eth*,interface-name:wan*,interface-name:lan*,interface-name:br*"

write_uboot_platform() {
	if [[ $2 == /dev/mmcblk* && -b ${2}boot0 ]]; then
		local device=${2}boot0
		echo 0 > /sys/block/$(basename $device)/force_ro
		local is_emmc=1
	else
		local device=${2}
	fi
}

